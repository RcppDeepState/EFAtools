% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PARALLEL.R
\name{PARALLEL}
\alias{PARALLEL}
\title{Parallel analysis}
\source{
Braeken, J., & van Assen, M. A. (2017). An empirical Kaiser criterion.
Psychological Methods, 22, 450 – 466. http://dx.doi.org/10.1037/ met0000074

Crawford, A. V., Green, S. B., Levy, R., Lo, W. J., Scott, L.,
Svetina, D., & Thompson, M. S. (2010). Evaluation of parallel analysis methods
for determining the number of factors. Educational and Psychological
Measurement, 70(6), 885-901.

Horn, J. L. (1965). A rationale and test for the number of factors in
factor analysis. Psychometrika, 30(2), 179–185. doi: 10.1007/BF02289447
}
\usage{
PARALLEL(
  x = NULL,
  n_cases = NA,
  n_vars = NA,
  n_datasets = 1000,
  percent = 95,
  eigen_type = c("SMC", "PCA", "EFA"),
  data_type = c("sim"),
  replace = TRUE,
  use = c("pairwise.complete.obs", "all.obs", "complete.obs", "everything",
    "na.or.complete"),
  decision_rule = c("Means", "Percentile", "Crawford"),
  criterion = 0.001,
  criterion_type = c("sums", "max_individual"),
  max_iter = 1000
)
}
\arguments{
\item{x}{matrix or data.frame. The real data to compare the simulated eigenvalues
against. Must not contain variables of classes other than numeric. Can be a
correlation matrix or raw data.}

\item{n_cases}{numeric. The number of cases / observations to simulate. Should only
be specified if \code{x} is left as \code{NULL} as otherwise the dimensions are taken from \code{x}.}

\item{n_vars}{numeric. The number of variables / indicators to simulate. Should only
be specified if \code{x} is left as \code{NULL} as otherwise the dimensions are taken from \code{x}.}

\item{n_datasets}{numeric. The number of datasets to simulate. Default is 1000.}

\item{percent}{numeric. A vector of percentiles to take the simulated eigenvalues from.
Default is 95.}

\item{eigen_type}{character. On what the eigenvalues should be found. Can be
either "SMC", "PCA", or "EFA". If using "SMC", the diagonal of the correlation
matrices is replaced by the squared multiple correlations (SMCs) of the
indicators. If using "PCA", the diagonal values of the correlation matrices
are left to be 1. If using "EFA", eigenvalues are found on the correlation
matrices with the final communalities of a 1 factor principal axis factoring
solution as diagonal.}

\item{data_type}{character. Currently only "sim" is implemented. Finds eigenvalues
for parallel analysis on simulated data.}

\item{replace}{logical. Currently ignored. Whether, if \code{data_type = "resample"}, the
resampling should be done with replacements or not. Default is \code{TRUE}.}

\item{use}{character. Passed to \code{\link[stats:cor]{stats::cor}} if raw data
is given as input. Default is "pairwise.complete.obs".}

\item{decision_rule}{character. Which rule to use to determine the number of
factors to retain. Default is \code{"mean"}, which will use the average
simulated eigenvalues. \code{"Percentile"}, uses the percentiles specified
in percent. \code{"Crawford"} uses the 95th percentile for the first factor
and the mean afterwards (based on Crawford et al, 2010).}

\item{criterion}{numeric. The convergence criterion.
If the change in communalities from one iteration to the next is smaller than
this criterion the solution is accepted and the procedure ends. Details
depend on criterion_type. Default is \code{.001}.}

\item{criterion_type}{character. "max_individual" selects the
maximum change in any of the communalities from one iteration to the next
and tests it against the specified criterion. This is also used by SPSS.
"sums" takes difference of the sum of all communalities in one iteration and
the sum of all communalities in the next iteration and tests it against the
criterion. This procedure is used by the \code{\link[psych:fa]{psych::fa}} function.
Default is \code{"sums"}.}

\item{max_iter}{numeric. The maximum number of iterations to
perform after which the iterative PAF procedure is halted with a warning.
Default is \code{1000}.}
}
\value{
A list of class PARALLEL containing the following objects
\item{eigenvalues}{A matrix containing the eigenvalues of the real and the simulated data.}
\item{n_factors}{The number of factors to retain according to the parallel procedure.}
\item{settings}{A list of control settings used in the print function.}
}
\description{
Various methods for performing parallel analysis. This function uses
\link{future.apply}{future_lapply} for which a parallel processing plan can
be selected. To do so, call \code{library(future)} and, for example,
 \code{plan(multisession)}; see examples.
}
\details{
Parallel analysis (Horn, 1965) compares the eigenvalues obtained from the sample
 correlation matrix against those of null model correlation matrices (i.e.,
 with uncorrelated variables) of the same sample size. This way, it accounts
 for the variation in eigenvalues introduced by sampling error and thus
 eliminates the main problem inherent in the Kaiser-Guttman criterion
 (\code{\link{KGC}}).

 Three different ways of finding the eigenvalues under the factor model are
 implemented, namely "SMC", "PCA", and "EFA". PCA leaves the diagonal elements
 of the correlation matrix as they are and is thus equivalent to what is done
 in PCA. SMC uses squared multiple correlations as communality estimates with
 which the diagonal of the correlation matrix is replaced. Finally, EFA performes
 an \code{\link{EFA}} with one factor to estimate
 the communalities and based on the correlation matrix with these as diagonal
 elements, finds the eigenvalues.

 Parallel analysis is often argued to be one of the most accurate factor
 retention criteria. However, for highly correlated
 factor structures it has been shown to underestimate the correct number of
 factors. The reason for this is that a null model (uncorrelated variables)
 is used as reference. However, when factors are highly correlated, the first
 eigenvalue will relatively be much larger than the following ones, as
 later eigenvalues are conditional on the earlier ones in the sequence and thus
 the shared variance is already accounted in the first eigenvalue (e.g.,
 Braeken & van Assen, 2017).
}
\examples{
\dontrun{
# example without real data
PARALLEL(n_cases = 500, n_vars = 10)
# example without correlation matrix
PARALLEL(test_models$case_11b$cormat, n_cases = test_models$case_11b$N)

# for parallel computation
future::plan(future::multisession)
PARALLEL(test_models$case_11b$cormat, n_cases = test_models$case_11b$N)
}
}
