% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EFA.R
\name{EFA}
\alias{EFA}
\title{Function to run PAF and obtain varimax or promax rotated loadings}
\usage{
EFA(x, n_factors, cors = TRUE, N = NA, rotation = "none",
  type = "SG", max_iter = NULL, init_comm = NULL, criterion = NULL,
  criterion_type = NULL, abs_eigen = NULL, signed_loadings = TRUE,
  use = "pairwise.complete.obs", k = NULL, kaiser = TRUE,
  P_type = NULL, precision = NULL, order_type = NULL)
}
\arguments{
\item{x}{data.frame or matrix. Dataframe or matrix of raw data or matrix with
correlations.}

\item{n_factors}{numeric. Number of factors to extract.}

\item{cors}{logical. If \code{TRUE} (default) a correlation matrix is expected in x,
otherwise raw data is expected.}

\item{N}{numeric. The number of observations. Needs only be specified if a
correlation matrix is used. If input is a correlation matrix and N = NA
(default), not all fit indices can be computed. See
\code{\link[psych:factor.stats]{psych::factor.stats}} for details.}

\item{rotation}{character. One of "none" (default), "promax", or "varimax".
Specifies the type of rotation to perform.}

\item{type}{character. If one of "SG" (default), "psych", or "SPSS" is
used, and the following arguments with default NULL are left with
NULL, these implementations are executed as reported in Steiner and Grieder
(2019). Individual properties can be adapted using one of the three types and
specifying some of the following arguments. If set to another value than one
of the three specified above, all following arguments must be specified. For
details see the helppages for \code{\link{PAF}}, \code{\link{PROMAX}}, or
\code{\link{VARIMAX}}}

\item{max_iter}{numeric. The maximum number of iterations (default is 300) to
perform after which the iterative PAF procedure is halted with a warning.}

\item{init_comm}{character. The method to estimate the initial communalities.
"smc" will use squared multiple correlations. "mac" will use
 maximum absolute correlations. "unity" will use 1s.}

\item{criterion}{numeric. The convergence criterion used in \code{\link{PAF}}.
If the change in communalities from one iteration to the next is smaller than
this criterion the solution is accepted and the procedure ends. Details
depend on criterion_type (see \code{\link{PAF}} documentation).}

\item{criterion_type}{character. Type of convergence criterion used in
\code{\link{PAF}}. "max_individual" selects the maximum change in any of the
communalities from one iteration to the next and tests it against the
specified criterion. This is also used by SPSS. "sums" takes difference of
the sum of all communalities in one iteration and the sum of all communalities
in the next iteration and tests it against the criterion. This procedure is
used by the \code{\link[psych:fa]{psych::fa}} function.}

\item{abs_eigen}{logical. Which algorithm to use in the \code{\link{PAF}}
iterations. If FALSE, the loadings are computed from the eigenvalues. This is
also used by the \code{\link[psych:fa]{psych::fa}} function. If TRUE the
loadings are computed with the absolute eigenvalues as done by SPSS. All
textbooks we know use \code{abs_eigen = FALSE}.}

\item{signed_loadings}{logical. If \code{TRUE} (default), the sign of
factors after PAF with negative sum of loadings is reflected. This is done by
both SPSS and \code{\link[psych:fa]{psych::fa}}.}

\item{use}{character. Passed to \code{\link[stats:cor]{stats::cor}} if raw data
is given as input. Note that in this case \code{cors} must be set to
\code{FALSE}.}

\item{k}{numeric. The power used for computing the target matrix P in the
promax rotation.}

\item{kaiser}{logical. If \code{TRUE} (default), kaiser normalization is
performed in the varimax rotation.}

\item{P_type}{character. Default is \code{NULL}. This specifies how the target
matrix P is computed in a promax rotation. If "HW" it will use the
implementation of Hendrickson and White (1964), which is also used by
the psych and stats packages. If "SPSS" it will use the SPSS version
(see \code{\link{PROMAX}} or Steiner and Grieder, 2019 for details).}

\item{precision}{numeric. The tolerance for stopping in the varimax procecdure.
This is passed to the "eps" argument of the
\code{\link[stats:varimax]{stats::varimax}} function. Default is \code{NULL}.}

\item{order_type}{character. How to order the factors and when to reflect
their signs. Default is \code{NULL}. "psych" will use the psych method, "SPSS" the
SPSS method. See \code{\link{PROMAX}} or \code{\link{VARIMAX}} for details.}
}
\value{
A list of type PAF if no rotation is used (see \code{\link{PAF}}
 documentation for a description), and of type PROMAX, or
 VARIMAX, if the respective rotation is used. In the latter cases the output
 list is of the following structure:

\item{orig_R}{Original correlation matrix.}
\item{h2_init}{Initial communality estimates from PAF.}
\item{h2}{Final communality estimates from unrotated loadings.}
\item{iter}{The number of iterations needed for convergence in PAF.}
\item{orig_eigen}{Eigen values of the original correlation matrix.}
\item{init_eigen}{Initial eigenvalues, obtained from the correlation matrix
 with the initial communality estimates as diagonal in PAF.}
\item{final_eigen}{Eigenvalues of the final iteration in PAF.}
\item{unrot_loadings}{Loading matrix containing the unrotated final loadings from PAF.}
\item{rot_loadings}{The promax or varimax rotated loadings (the pattern matrix).}
\item{rotmat}{The rotation matrix.}
\item{Phi}{The factor intercorrelations. Only returned if promax rotation is used.}
\item{Structure}{The structure matrix. Only returned if promax rotation is used.}
\item{vars_accounted}{Matrix of explained variances and sums of squared loadings. Based on rotated loadings and, if applicable, the factor intercorrelations.}
\item{fit_indices}{Fit indices derived from the rotated factor loadings as
 returned by \code{\link[psych:factor.stats]{psych::factor.stats}}}
}
\description{
This is just a wrapper function to call \code{\link{PAF}} and then one of
\code{\link{PROMAX}} or \code{\link{VARIMAX}} or no rotation is performed.
}
